<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Login â€¢ Project Management</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
	<script src="https://cdn.tailwindcss.com"></script>
	<link rel="stylesheet" href="/styles.css" />
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-100 grid place-items-center">
	<div class="card w-full max-w-xl p-0 overflow-hidden">
		<div class="grid md:grid-cols-[1.1fr_.9fr]">
			<div class="p-6 sm:p-8">
				<h1 class="text-2xl font-semibold text-slate-900 mb-1">Welcome back</h1>
				<p class="text-slate-500 mb-6">Sign in to continue</p>
				<form id="loginForm" class="grid gap-3 sm:grid-cols-[1fr_1fr_auto]">
					<input id="username" class="input" type="text" placeholder="Username" required />
					<input id="password" class="input" type="password" placeholder="Password" required />
					<button class="btn-primary">Login</button>
				</form>
				<p id="authMsg" class="text-sm text-red-600 mt-2 hidden"></p>
				<p class="text-sm text-slate-600 mt-6">Don't have an account? <a class="text-slate-900 underline" href="/signup.html">Sign up</a></p>
			</div>
			<div class="bg-slate-900 text-slate-100 p-6 sm:p-8">
				<h3 class="font-semibold mb-2">Demo accounts</h3>
				<p class="text-slate-300 text-sm">manager/manager123<br/>employee/employee123</p>
			</div>
		</div>
	</div>

	<script>
	const form = document.getElementById('loginForm');
	form.addEventListener('submit', async (e) => {
		e.preventDefault();
		const username = document.getElementById('username').value.trim();
		const password = document.getElementById('password').value;
		try {
			const res = await fetch('/api/auth/login', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({username, password})});
			if(!res.ok) throw new Error();
			const data = await res.json();
			localStorage.setItem('token', data.token);
			localStorage.setItem('username', username);
			try { await fetch('/api/tasks/assigned-by-me', {headers:{Authorization:`Bearer ${data.token}`}}); localStorage.setItem('role','MANAGER'); }
			catch { localStorage.setItem('role','EMPLOYEE'); }
			location.href = '/';
		} catch {
			document.getElementById('authMsg').textContent = 'Invalid credentials';
			document.getElementById('authMsg').classList.remove('hidden');
		}
	});
	</script>
</body>
</html>



